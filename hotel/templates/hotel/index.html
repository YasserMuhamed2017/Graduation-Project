{% extends "hotel/base.html" %}
{% block title %}Home{% endblock %}
{% block content %}


<div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
      aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
      aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
      aria-label="Slide 3"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img class="d-block w-100" src="/static/img/1407953244000-177513283.webp" alt="First slide">
    </div>
    <div class="carousel-item">
      <img class="d-block w-100" src="/static/img/premium_photo-1661964071015-d97428970584.jpeg" alt="Second slide">
    </div>
    <div class="carousel-item">
      <img class="d-block w-100" src="/static/img/Homepage-jumbotron.webp" alt="Third slide">
    </div>
  </div>
</div>

<style>
  .search-form {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    margin-top: 20px;
  }
</style>



<div class="container my-4">
  <input type="text" id="searchInput" class="form-control my-5" placeholder="Search by hotel name or location">
</div>


<div class="container">
  <h2 class="mb-4" id="searchTitle">All Hotels</h2>
  <div class="row g-4" id="default-hotels">
    {% for hotel in hotels %}
    <div class="col-md-4">
      <div class="card h-100 shadow-sm border-0 rounded-4 overflow-hidden">
        <div class="position-relative">
          <img src="{{ hotel.image.url }}" class="card-img-top" alt="{{ hotel.name }}"
            style="height: 250px; object-fit: cover;">
        </div>
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">{{ hotel.name }}</h5>
          <h6 class="card-subtitle text-muted mb-2">{{ hotel.location }}</h6>
          <p class="card-text">{{ hotel.description|truncatewords:10 }}</p>
          <p class="card-text">Contact: {{ hotel.contact_number }}</p>
          <div class="mt-auto">
            <a href="{% url 'hotel_detail' hotel.pk %}" class="btn btn-primary w-100 rounded-pill">View Details</a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>


<script>
  const searchInput = document.getElementById('searchInput');
  const resultsContainer = document.getElementById('default-hotels');
  const searchTitle = document.getElementById('searchTitle');

  searchInput.addEventListener('input', function () {
    const query = searchInput.value.trim();

    fetch(`/hotel/ajax/hotel-search/?location=${encodeURIComponent(query)}`)

      .then(response => response.json())
      .then(data => {
        resultsContainer.innerHTML = '';

        if (!query) {
          searchTitle.textContent = 'All Hotels';
        } else {
          searchTitle.textContent = `Search Results for "${query}"`;
        }

        if (data.hotels.length === 0) {
          resultsContainer.innerHTML = '<p>No results found.</p>';
          return;
        }

        data.hotels.forEach(hotel => {
          const hotelCard = `
            <div class="col-md-4">
              <div class="card h-100 shadow-sm border-0 rounded-4 overflow-hidden">
                <div class="position-relative">
                  <img src="${hotel.image_url}" class="card-img-top" alt="${hotel.name}" style="height: 250px; object-fit: cover;">
                </div>
                <div class="card-body d-flex flex-column">
                  <h5 class="card-title">${hotel.name}</h5>
                  <h6 class="card-subtitle text-muted mb-2">${hotel.location}</h6>
                  <p class="card-text">${hotel.description}</p>
                  <p class="card-text">Contact: ${hotel.contact_number}</p>
                  <div class="mt-auto">
                    <a href="/hotel/hotel/${hotel.id}/" class="btn btn-primary w-100 rounded-pill">View Details</a>
                  </div>
                </div>
              </div>
            </div>
          `;
          resultsContainer.innerHTML += hotelCard;
        });
      });
  });
</script>

</div>

{% endblock %}
