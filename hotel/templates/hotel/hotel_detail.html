{% extends "hotel/base.html" %}
{% load static %}

{% block content %}

<!-- AOS CSS -->
<link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

<div class="container my-5">
  <div class="container my-5" data-aos="fade-up">
      <!-- Hotel Image Gallery Section -->
      <div class="row" data-aos="fade-up">
          <div class="col-md-12 mb-4 position-relative">
              <!-- Main Hotel Image with Overlay -->
              <div style="height:70vh; width:100%; overflow:hidden; position:relative;" class="rounded-4 shadow">
                  <img style="height:70vh; width:100%; object-fit: cover; filter: brightness(0.9);" src="{{ hotel.image.url }}"
                      class="img-fluid" alt="{{ hotel.name }}">
                  
                  <!-- Elegant Overlay with Hotel Name -->
                  <div class="position-absolute bottom-0 start-0 w-100 p-4" 
                       style="background: linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0));">
                      <div class="container">
                          <h1 class="text-white fw-bold display-4 mb-0">{{ hotel.name }}</h1>
                          <p class="text-white mb-2">
                              <i class="fas fa-map-marker-alt me-2"></i>{{ hotel.location }}
                          </p>
                          <div class="mb-2">
                              {% with rating=hotel.rating %}
                                {% for i in "12345" %}
                                  {% if rating >= forloop.counter %}
                                    <i class="fas fa-star text-warning fs-5"></i>
                                  {% elif rating >= forloop.counter0|add:"0.5" %}
                                    <i class="fas fa-star-half-alt text-warning fs-5"></i>
                                  {% else %}
                                    <i class="far fa-star text-warning fs-5"></i>
                                  {% endif %}
                                {% endfor %}
                              {% endwith %}
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- Hotel Details Card -->
          <div class="col-md-12 mb-4" data-aos="fade-up">
            <div class="p-0 bg-white rounded-4 shadow overflow-hidden">
              
              <!-- Hotel Navigation Tabs -->
              <ul class="nav nav-tabs px-4 pt-3 bg-light" id="hotelDetailsTabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <button class="nav-link active fw-semibold" id="overview-tab" data-bs-toggle="tab" 
                          data-bs-target="#overview" type="button" role="tab" aria-selected="true">
                    <i class="fas fa-info-circle me-2"></i>Overview
                  </button>
                </li>
                <!-- <li class="nav-item" role="presentation">
                  <button class="nav-link fw-semibold" id="amenities-tab" data-bs-toggle="tab" 
                          data-bs-target="#amenities" type="button" role="tab" aria-selected="false">
                    <i class="fas fa-concierge-bell me-2"></i>Amenities
                  </button>
                </li> -->
                <li class="nav-item" role="presentation">
                  <button class="nav-link fw-semibold" id="contact-tab" data-bs-toggle="tab" 
                          data-bs-target="#contact" type="button" role="tab" aria-selected="false">
                    <i class="fas fa-phone me-2"></i>Contact
                  </button>
                </li>
              </ul>
              
              <!-- Tab Content -->
              <div class="tab-content p-4" id="hotelDetailsTabContent">
                <!-- Overview Tab -->
                <div class="tab-pane fade show active" id="overview" role="tabpanel">
                  <div class="row">
                    <div class="col-md-8">
                      <h4 class="text-primary border-bottom pb-2 mb-3">About This Hotel</h4>
                      <p class="mb-4 fs-5">{{ hotel.description }}</p>
                      
                      <div class="d-flex flex-wrap mb-4">
                        <div class="bg-light rounded-3 p-3 me-3 mb-3 text-center" style="min-width: 100px">
                          <i class="fas fa-bed text-primary fs-4 mb-2"></i>
                          <p class="mb-0 small">Premium Rooms</p>
                        </div>
                        <div class="bg-light rounded-3 p-3 me-3 mb-3 text-center" style="min-width: 100px">
                          <i class="fas fa-wifi text-primary fs-4 mb-2"></i>
                          <p class="mb-0 small">Free WiFi</p>
                        </div>
                        <div class="bg-light rounded-3 p-3 me-3 mb-3 text-center" style="min-width: 100px">
                          <i class="fas fa-utensils text-primary fs-4 mb-2"></i>
                          <p class="mb-0 small">Restaurant</p>
                        </div>
                        <div class="bg-light rounded-3 p-3 me-3 mb-3 text-center" style="min-width: 100px">
                          <i class="fas fa-parking text-primary fs-4 mb-2"></i>
                          <p class="mb-0 small">Parking</p>
                        </div>
                      </div>
                    </div>
                    
                    <div class="col-md-4">
                      <div class="card h-100 bg-light border-0">
                        <div class="card-body">
                          <h5 class="card-title text-primary mb-3">Hotel Highlights</h5>
                          <ul class="list-unstyled">
                            <li class="mb-2">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>24/7 Front Desk</span>
                            </li>
                            <li class="mb-2">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Air Conditioning</span>
                            </li>
                            <li class="mb-2">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Non-smoking Rooms</span>
                            </li>
                            <li class="mb-2">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Family Rooms</span>
                            </li>
                            <li class="mb-2">
                              <i class="fas fa-check-circle text-success me-2"></i>
                              <span>Daily Housekeeping</span>
                            </li>
                          </ul>
                          <div class="mt-4">
                            <h6 class="text-dark">Guest Rating</h6>
                            <div class="d-flex align-items-center">
                              <span class="bg-primary text-white rounded-2 px-2 py-1 me-2">{{ hotel.rating }}</span>
                              <div>
                                {% with rating=hotel.rating %}
                                  {% for i in "12345" %}
                                    {% if rating >= forloop.counter %}
                                      <i class="fas fa-star text-warning"></i>
                                    {% elif rating >= forloop.counter0|add:"0.5" %}
                                      <i class="fas fa-star-half-alt text-warning"></i>
                                    {% else %}
                                      <i class="far fa-star text-warning"></i>
                                    {% endif %}
                                  {% endfor %}
                                {% endwith %}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Amenities Tab -->
                <div class="tab-pane fade" id="amenities" role="tabpanel">
                  <h4 class="text-primary border-bottom pb-2 mb-4">Hotel Amenities</h4>
                  <div class="row g-4">
                    <div class="col-md-6">
                      <h5 class="mb-3"><i class="fas fa-swimmer text-primary me-2"></i>Recreation</h5>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Swimming Pool
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Fitness Center
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Spa & Wellness
                        </li>
                      </ul>
                    </div>
                    <div class="col-md-6">
                      <h5 class="mb-3"><i class="fas fa-concierge-bell text-primary me-2"></i>Services</h5>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Room Service
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Airport Shuttle
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Laundry Service
                        </li>
                      </ul>
                    </div>
                    <div class="col-md-6">
                      <h5 class="mb-3"><i class="fas fa-utensils text-primary me-2"></i>Food & Drink</h5>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Restaurant
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Bar/Lounge
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Breakfast Available
                        </li>
                      </ul>
                    </div>
                    <div class="col-md-6">
                      <h5 class="mb-3"><i class="fas fa-business-time text-primary me-2"></i>Business</h5>
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Conference Rooms
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Business Center
                        </li>
                        <li class="list-group-item bg-transparent px-0">
                          <i class="fas fa-check-circle text-success me-2"></i>Meeting Facilities
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                
                <!-- Contact Tab -->
                <div class="tab-pane fade" id="contact" role="tabpanel">
                  <h4 class="text-primary border-bottom pb-2 mb-4">Contact Information</h4>
                  <div class="row">
                    <div class="col-md-6">
                      <div class="d-flex mb-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 rounded-circle bg-primary bg-opacity-10">
                            <i class="fas fa-phone text-primary fs-4"></i>
                          </div>
                        </div>
                        <div class="ms-3">
                          <h5>Phone Number</h5>
                          <p class="mb-0 fs-5">{{ hotel.contact_number }}</p>
                        </div>
                      </div>
                      
                      <div class="d-flex mb-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 rounded-circle bg-primary bg-opacity-10">
                            <i class="fas fa-envelope text-primary fs-4"></i>
                          </div>
                        </div>
                        <div class="ms-3">
                          <h5>Email</h5>
                          <p class="mb-0 fs-5">info@{{ hotel.name|lower|cut:" " }}.com</p>
                        </div>
                      </div>
                      
                      <div class="d-flex mb-4">
                        <div class="flex-shrink-0">
                          <div class="p-3 rounded-circle bg-primary bg-opacity-10">
                            <i class="fas fa-map-marker-alt text-primary fs-4"></i>
                          </div>
                        </div>
                        <div class="ms-3">
                          <h5>Address</h5>
                          <p class="mb-0 fs-5">{{ hotel.location }}</p>
                        </div>
                      </div>
                    </div>
                    
                    <div class="col-md-6">
                      <div class="ratio ratio-4x3">
                        <iframe 
                          src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBFw0Qbyq9zTFTd-tUY6dZWTgaQzuU17R8&q={{ hotel.latitude }},{{ hotel.longitude }}" 
                          style="border:0;" 
                          allowfullscreen="" 
                          loading="lazy" 
                          referrerpolicy="no-referrer-when-downgrade"
                          class="rounded-4 shadow">
                        </iframe>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </div>
    </div>
</div>

<!-- Search Form -->
<div class="container" data-aos="fade-up">
  
<div class="row">
  <div class="col-md-2">
    <h4 class="mb-4">Filter by : </h4>

     <div class="search-form mb-5" data-aos="fade-up">
      <form method="get">
        <div class="row">
          
          <!-- Room Type -->
          <div class="col-md-12 mb-3">
            <label for="room_type" class="form-label">Room Type</label>
            <select id="room_type" name="room_type" class="form-select">
              <option value="">All Types</option>
              <option value="Single" {% if selected_room_type == 'Single' %}selected{% endif %}>Single</option>
              <option value="Double" {% if selected_room_type == 'Double' %}selected{% endif %}>Double</option>
              <option value="Suite" {% if selected_room_type == 'Suite' %}selected{% endif %}>Suite</option>
            </select>
          </div>
  
          <!-- Availability -->
          <div class="col-md-12 mb-3">
            
            <label for="availability" class="form-label">Availability</label>
            <select id="availability" name="availability" class="form-select">
              <option value="">All</option>
              <option value="available" {% if selected_availability == 'available' %}selected{% endif %}>Available</option>
              <option value="unavailable" {% if selected_availability == 'unavailable' %}selected{% endif %}>Not Available</option>
            </select>
          </div>
  
        </div>
      </form>
    </div>
     


  </div>
  <div class="col-md-10 border-start">
    <h4 class="mb-4" id="rooms" > Rooms </h4>
    <h4 class="mb-4" id="result-rooms" hidden> Result Rooms </h4>
    <input type="hidden" id="hotel-id" value="{{ hotel.id }}">
    <div class="row g-4" id="filtered-rooms">
    {% include 'hotel/partials/room_list.html' with rooms=rooms %}
  </div>

</div>
</div>
</div>
<!-- Reviews Section -->
<!-- <div class="container my-5" data-aos="fade-up">
  <div class="row">
    <hr>
    <h3>Reviews</h3>
<div class="card border-0 rounded-4 shadow mt-4">
  <div class="card-body p-4">
      <h5 class="text-primary border-bottom pb-2 mb-4">
          <i class="fas fa-star me-2"></i>Guest Reviews ({{ reviews.count }})
      </h5> -->
      
      <!-- Add Review Form -->
      <!-- {% if user.is_authenticated %}
      <div class="mb-4">
          <form method="post" action="">
              {% csrf_token %}
              <div class="mb-3">
                  <label for="rating" class="form-label">Your Rating</label>
                  <div class="rating-stars mb-2">
                      <i class="far fa-star fs-4 star-rating" data-rating="1"></i>
                      <i class="far fa-star fs-4 star-rating" data-rating="2"></i>
                      <i class="far fa-star fs-4 star-rating" data-rating="3"></i>
                      <i class="far fa-star fs-4 star-rating" data-rating="4"></i>
                      <i class="far fa-star fs-4 star-rating" data-rating="5"></i>
                  </div>
                  <input type="hidden" name="rating" id="rating" value="">
              </div>
              <div class="mb-3">
                  <label for="review_text" class="form-label">Your Review</label>
                  <textarea class="form-control" id="review_text" name="review_text" rows="3" placeholder="Share your experience staying in this room..."></textarea>
              </div>
              <button type="submit" class="btn btn-sm text-white" style="background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);">
                  <i class="fas fa-paper-plane me-2"></i>{% if user_has_reviewed %}Update Review{% else %}Submit Review{% endif %}
              </button>
          </form>
      </div>
      {% else %}
      <div class="alert alert-info">
          <i class="fas fa-info-circle me-2"></i>Please <a href="{% url 'login' %}">login</a> to leave a review.
      </div>
      {% endif %} -->
      
      <!-- Dynamic Reviews List -->
      <!-- <div class="reviews-list">
          {% if reviews %}
              {% for review in reviews %}
                  <div class="review-item {% if not forloop.last %}mb-3 pb-3 border-bottom{% endif %}">
                      <div class="d-flex align-items-center mb-2">
                          <div class="me-2">
                              {% if review.user.profile_picture %}
                                  <img src="{{ review.user.profile_picture.url }}" alt="{{ review.user.first_name }}" class="rounded-circle" width="40" height="40">
                              {% else %}
                                  <div class="rounded-circle bg-primary bg-opacity-10 d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                      <i class="fas fa-user text-primary"></i>
                                  </div>
                              {% endif %}
                          </div>
                          <div>
                              <h6 class="mb-0">{{ review.user.first_name }} {{ review.user.last_name }}</h6>
                              <div class="text-warning">
                                  {% for i in "12345" %}
                                      {% if review.rating >= forloop.counter %}
                                          <i class="fas fa-star"></i>
                                      {% elif review.rating >= forloop.counter0|add:"0.5" %}
                                          <i class="fas fa-star-half-alt"></i>
                                      {% else %}
                                          <i class="far fa-star"></i>
                                      {% endif %}
                                  {% endfor %}
                              </div>
                          </div>
                          <div class="ms-auto text-muted small">
                              {{ review.created_at|timesince }} ago
                          </div>
                      </div>
                      <p class="mb-0">{{ review.comment }}</p>
                  </div>
              {% endfor %}
          {% else %}
              <div class="text-center py-4">
                  <i class="far fa-comment-dots fs-4 text-muted mb-2"></i>
                  <p class="mb-0 text-muted">No reviews yet. Be the first to review this room!</p>
              </div>
          {% endif %}
      </div>
  </div>
</div>
</div>
</div> -->
<!-- Scripts -->
  <!-- AOS JS -->
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script src="{% static 'js/room_filter.js' %}"></script>

{% endblock %}
