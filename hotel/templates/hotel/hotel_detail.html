{% extends "hotel/base.html" %}
{% load static %}

{% block content %}

<!-- AOS CSS -->
<link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

{% comment %} <div class="container my-5">
  
    <div class="container my-5">
        <div class="row">
            <div class="col-md-8" style="height:60vh ;width:100 ;overflow:hidden">
                <img style="height:60vh; width:90%; object-fit: cover;" src="{{ hotel.image.url }}"
                    class="img-fluid rounded-4 shadow" alt="{{ hotel.name }}">
            </div>
            <div class="col-md-4">
                <h1 class="mb-3">{{ hotel.name }}</h1>
                <p class="text-muted">{{ hotel.location }}</p>
                <p>{{ hotel.description }}</p>
    
                <h5>Contact:</h5>
                <p>{{ hotel.contact_number }}</p>
    
                <h5>Hotel Rating:</h5>
                <p>
                    {% with rating=hotel.rating %}
                    {% for i in "12345" %}
                    {% if rating >= forloop.counter %}
                    <i class="fas fa-star text-warning"></i>
                    {% elif rating >= forloop.counter0|add:"0.5" %}
                    <i class="fas fa-star-half-alt text-warning"></i>
                    {% else %}
                    <i class="far fa-star text-warning"></i>
                    {% endif %}
                    {% endfor %}
                    {% endwith %}
                </p>
    
    
            </div>
        </div>
        <br>
        <br>
  <!-- Search Form -->
  <div class="search-form mb-5">
    <form method="get">
      <div class="row">
        
        <!-- Room Type -->
        <div class="col-md-4 mb-3">
          <label for="room_type" class="form-label">Room Type</label>
          <select id="room_type" name="room_type" class="form-select">
            <option value="">All Types</option>
            <option value="Single" {% if selected_room_type == 'Single' %}selected{% endif %}>Single</option>
            <option value="Double" {% if selected_room_type == 'Double' %}selected{% endif %}>Double</option>
            <option value="Suite" {% if selected_room_type == 'Suite' %}selected{% endif %}>Suite</option>
          </select>
        </div>

        <!-- Availability -->
        <div class="col-md-4 mb-3">
          <label for="availability" class="form-label">Availability</label>
          <select id="availability" name="availability" class="form-select">
            <option value="">All</option>
            <option value="available" {% if selected_availability == 'available' %}selected{% endif %}>Available</option>
            <option value="unavailable" {% if selected_availability == 'unavailable' %}selected{% endif %}>Not Available</option>
          </select>
        </div>

        <!-- Search Button -->
        <div class="col-md-4 d-flex align-items-end mb-3">
          <button type="submit" class="btn btn-primary w-100">Search</button>
        </div>
      </div>
    </form>

    <!-- Reset Filters -->
    <div class="text-end">
      <a href="{% url 'hotel_detail' hotel.id %}" class="btn btn-secondary btn-sm mt-2">Reset Filters</a>
    </div>
  </div>

  <!-- Rooms Section -->
  {% if selected_room_type %}
    <!-- User selected a specific room type: show rooms directly -->
    <div class="row g-4">
      {% for room in rooms %}
        <div class="col-md-4">
          <div class="card h-100 shadow-sm border-0 rounded-4 overflow-hidden">
            
            {% if room.room_image %}
              <img src="{{ room.room_image.url }}" class="card-img-top" alt="Room {{ room.room_number }}" style="height: 250px; object-fit: cover;">
            {% else %}
              <img src="{% static 'images/default_room.jpg' %}" class="card-img-top" alt="No Image" style="height: 250px; object-fit: cover;">
            {% endif %}

            <div class="card-body d-flex flex-column">
              <h5 class="card-title">{{ room.room_type }} Room - {{ room.room_number }}</h5>
              <p class="card-text"><strong>Price:</strong> ${{ room.price_per_night }} per night</p>
              <p class="card-text"><strong>Amenities:</strong> {{ room.amenities }}</p>
              <p class="card-text">
                <strong>Status:</strong>
                {% if room.availability %}
                  <span class="badge bg-success">Available</span>
                {% else %}
                  <span class="badge bg-danger">Not Available</span>
                {% endif %}
              </p>

              <div class="mt-auto">
                <a href="#" class="btn btn-outline-primary w-100 rounded-pill">View Room</a>
              </div>
            </div>

          </div>
        </div>
      {% empty %}
        <div class="col-12 text-center">
          <p class="text-muted">No rooms found matching your search.</p>
        </div>
      {% endfor %}
    </div>

  {% else %}
    <!-- No specific room type selected: group rooms by type -->
    {% for room_type, grouped_rooms in grouped_rooms_by_type.items %}
      <h3 class="mt-5 mb-3">{{ room_type }} Rooms</h3>
      <div class="row g-4">
        {% for room in grouped_rooms %}
          <div class="col-md-4">
            <div class="card h-100 shadow-sm border-0 rounded-4 overflow-hidden">
              
              {% if room.room_image %}
                <img src="{{ room.room_image.url }}" class="card-img-top" alt="Room {{ room.room_number }}" style="height: 250px; object-fit: cover;">
              {% else %}
                <img src="{% static 'images/default_room.jpg' %}" class="card-img-top" alt="No Image" style="height: 250px; object-fit: cover;">
              {% endif %}

              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ room.room_type }} Room - {{ room.room_number }}</h5>
                <p class="card-text"><strong>Price:</strong> ${{ room.price_per_night }} per night</p>
                <p class="card-text"><strong>Amenities:</strong> {{ room.amenities }}</p>
                <p class="card-text">
                  <strong>Status:</strong>
                  {% if room.availability %}
                    <span class="badge bg-success">Available</span>
                  {% else %}
                    <span class="badge bg-danger">Not Available</span>
                  {% endif %}
                </p>

                <div class="mt-auto">
                  <a href="#" class="btn btn-outline-primary w-100 rounded-pill">View Room</a>
                </div>
              </div>

            </div>
          </div>
        {% endfor %}
      </div>
    {% endfor %}
  {% endif %}

</div> {% endcomment %}


<div class="container my-5">
  
  <div class="container my-5" data-aos="fade-up">
      <div class="row" data-aos="fade-up">
          <div class="col-md-12 mb-4" style="height:70vh ;width:100 ;overflow:hidden">
              <img style="height:70vh; width:100%; object-fit: cover;" src="{{ hotel.image.url }}"
                  class="img-fluid rounded-4 shadow" alt="{{ hotel.name }}">
          </div>
          <div class="col-md-12 mb-4" data-aos="fade-left">
            <div class="p-4 bg-white rounded-4 shadow-sm border border-light-subtle">
              <!-- Hotel Name and Location -->
              <div class="mb-3">
                <h1 class="fw-bold text-primary mb-1">{{ hotel.name }}</h1>
                <p class="text-muted mb-0"><i class="fas fa-map-marker-alt me-1 text-primary"></i>{{ hotel.location }}</p>
              </div>

              <!-- Description -->
              <div class="mb-3">
                <h5 class="text-secondary fw-semibold">About</h5>
                <p class="mb-0">{{ hotel.description }}</p>
              </div>

              <!-- Contact -->
              <div class="mb-3">
                <h5 class="text-secondary fw-semibold">Contact</h5>
                <p class="mb-0"><i class="fa-solid fa-phone text-primary"></i> {{ hotel.contact_number }}</p>
              </div>

              <!-- Rating -->
              <div>
                <h5 class="text-secondary fw-semibold">Hotel Rating</h5>
                <div>
                  {% with rating=hotel.rating %}
                    {% for i in "12345" %}
                      {% if rating >= forloop.counter %}
                        <i class="fas fa-star text-warning"></i>
                      {% elif rating >= forloop.counter0|add:"0.5" %}
                        <i class="fas fa-star-half-alt text-warning"></i>
                      {% else %}
                        <i class="far fa-star text-warning"></i>
                      {% endif %}
                    {% endfor %}
                  {% endwith %}
                </div>
              </div>
            </div>
          </div>
      </div>
    </div>

          {% comment %} <div class="col-md-12">
              <h1 class="mb-3">{{ hotel.name }}</h1>
              <p class="text-muted">{{ hotel.location }}</p>
              <p>{{ hotel.description }}</p>
  
              <h5>Contact:</h5>
              <p>{{ hotel.contact_number }}</p>
  
              <h5>Hotel Rating:</h5>
              <p>
                  {% with rating=hotel.rating %}
                  {% for i in "12345" %}
                  {% if rating >= forloop.counter %}
                  <i class="fas fa-star text-warning"></i>
                  {% elif rating >= forloop.counter0|add:"0.5" %}
                  <i class="fas fa-star-half-alt text-warning"></i>
                  {% else %}
                  <i class="far fa-star text-warning"></i>
                  {% endif %}
                  {% endfor %}
                  {% endwith %}
              </p>
  
  
          </div> {% endcomment %}
</div>

<!-- Search Form -->
<div class="container my-5" data-aos="fade-up">
  <div class="row mb-3">
    <div class="col-md-8">
      <input id="booking-calendar" class="form-control" type="text" readonly style="background-color: white; cursor: pointer;">
    </div>
  </div>
<div class="row">
  <div class="col-md-2">
    <h4 class="mb-4">Filter by : </h4>

    {% comment %} <div class="search-form mb-5">
      <form id="search-form">
        <div class="row">
          <!-- Room Type -->
          <div class="col-md-12 mb-4">
            <div class="p-3 border rounded-4 shadow-sm bg-light">
              <label class="form-label fw-semibold text-primary">Room Type</label>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="room_type" id="type_all" value="" {% if not selected_room_type %}checked{% endif %}>
                <label class="form-check-label" for="type_all">All Types</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="room_type" id="type_single" value="Single" {% if selected_room_type == 'Single' %}checked{% endif %}>
                <label class="form-check-label" for="type_single">Single</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="room_type" id="type_double" value="Double" {% if selected_room_type == 'Double' %}checked{% endif %}>
                <label class="form-check-label" for="type_double">Double</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="room_type" id="type_suite" value="Suite" {% if selected_room_type == 'Suite' %}checked{% endif %}>
                <label class="form-check-label" for="type_suite">Suite</label>
              </div>
            </div>
          </div>
    
          <!-- Availability -->
          <div class="col-md-12 mb-4">
            <div class="p-3 border rounded-4 shadow-sm bg-light">
              <label class="form-label fw-semibold text-primary">Availability</label>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="availability" id="avail_all" value="" {% if not selected_availability %}checked{% endif %}>
                <label class="form-check-label" for="avail_all">All</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="availability" id="avail_available" value="available" {% if selected_availability == 'available' %}checked{% endif %}>
                <label class="form-check-label" for="avail_available">Available</label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="availability" id="avail_unavailable" value="unavailable" {% if selected_availability == 'unavailable' %}checked{% endif %}>
                <label class="form-check-label" for="avail_unavailable">Not Available</label>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
     {% endcomment %}
     <div class="search-form mb-5" data-aos="fade-up">
      <form method="get">
        <div class="row">
          
          <!-- Room Type -->
          <div class="col-md-12 mb-3">
            <label for="room_type" class="form-label">Room Type</label>
            <select id="room_type" name="room_type" class="form-select">
              <option value="">All Types</option>
              <option value="Single" {% if selected_room_type == 'Single' %}selected{% endif %}>Single</option>
              <option value="Double" {% if selected_room_type == 'Double' %}selected{% endif %}>Double</option>
              <option value="Suite" {% if selected_room_type == 'Suite' %}selected{% endif %}>Suite</option>
            </select>
          </div>
  
          <!-- Availability -->
          <div class="col-md-12 mb-3">
            
            <label for="availability" class="form-label">Availability</label>
            <select id="availability" name="availability" class="form-select">
              <option value="">All</option>
              <option value="available" {% if selected_availability == 'available' %}selected{% endif %}>Available</option>
              <option value="unavailable" {% if selected_availability == 'unavailable' %}selected{% endif %}>Not Available</option>
            </select>
          </div>
  
        </div>
      </form>
    </div>
     


  </div>
  <div class="col-md-10 border-start">
    <h4 class="mb-4">Result Rooms</h4>
    <input type="hidden" id="hotel-id" value="{{ hotel.id }}">
    <div class="row g-4" id="filtered-rooms">
    {% include 'hotel/partials/room_list.html' with rooms=rooms %}
  </div>

</div>
</div>
</div>


<!-- Scripts -->
  <!-- AOS JS -->
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
<script src="{% static 'js/room_filter.js' %}"></script>

{% endblock %}
